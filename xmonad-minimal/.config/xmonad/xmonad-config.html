<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-10-14 Sat 18:10 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>XMonad Configuration</title>
<meta name="author" content="Yusef Aslam" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">XMonad Configuration</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org9483f7c">1. <span class="done DONE">DONE</span> Add tiled window dragging</a></li>
<li><a href="#org69be568">2. <span class="todo TODO">TODO</span> Add clock only when fullscreen window is active</a>
<ul>
<li><a href="#org3369a83">2.1. Usecase</a></li>
</ul>
</li>
<li><a href="#org72b4555">3. NOTE Fix XMonad Installation on Arch with Cabal</a></li>
<li><a href="#orgb2da3b5">4. GHC LANGUAGE options</a></li>
<li><a href="#org2c6cd12">5. Imports</a></li>
<li><a href="#org6bdf00e">6. Rescreen configuration</a></li>
<li><a href="#orgcebe01e">7. AppIcon configuration</a></li>
<li><a href="#orge677595">8. Status bar configuration</a></li>
<li><a href="#org588033f">9. Workspaces</a></li>
<li><a href="#org38c0817">10. Main block and Keybinds</a>
<ul>
<li><a href="#orgd065712">10.1. Mouse keybinds</a></li>
</ul>
</li>
<li><a href="#org993ceb9">11. Startuphook</a></li>
<li><a href="#org6f6155d">12. Misc</a>
<ul>
<li><a href="#org20edf53">12.1. iconPath function</a></li>
<li><a href="#org1fb9e3c">12.2. Slightly modified layout transformer</a></li>
</ul>
</li>
<li><a href="#org7d34884">13. Layouthook</a></li>
<li><a href="#org4b5e7e6">14. Misc</a></li>
<li><a href="#org7ceeec6">15. Managehook</a></li>
</ul>
</div>
</div>

<div id="outline-container-org9483f7c" class="outline-2">
<h2 id="org9483f7c"><span class="section-number-2">1.</span> <span class="done DONE">DONE</span> Add tiled window dragging</h2>
</div>

<div id="outline-container-org69be568" class="outline-2">
<h2 id="org69be568"><span class="section-number-2">2.</span> <span class="todo TODO">TODO</span> Add clock only when fullscreen window is active</h2>
<div class="outline-text-2" id="text-2">
<p>
I want to utilize <a href="file:///home/yaslam/.dotfiles/binaries/bin/binaries.html#org2938dc1">dzen2script.sh</a> to provide a clock in the top left of the screen when a fullscreen window is present, for example, the XMonad manageHook will check to see if there is a fullscreen window present, if there is raise dzen2, if there isn't, lower dzen2.
</p>
</div>
<div id="outline-container-org3369a83" class="outline-3">
<h3 id="org3369a83"><span class="section-number-3">2.1.</span> Usecase</h3>
<div class="outline-text-3" id="text-2-1">
<p>
I want to be able to check the time while I'm playing a game or watching a video, without having to go out of fullscreen or pressing a keybind, this can be useful for that.
</p>
</div>
</div>
</div>

<div id="outline-container-org72b4555" class="outline-2">
<h2 id="org72b4555"><span class="section-number-2">3.</span> NOTE Fix XMonad Installation on Arch with Cabal</h2>
<div class="outline-text-2" id="text-3">
<p>
In Arch, with <code>ghc-static</code> installed, cabal-install usually fails with error: There are files missing in the `XXX' package, the fix is described below:
<a href="https://stackoverflow.com/questions/52429645/haskell-there-are-files-missing-in-the-quickcheck-2-11-3-package">https://stackoverflow.com/questions/52429645/haskell-there-are-files-missing-in-the-quickcheck-2-11-3-package</a>
</p>
</div>
</div>


<div id="outline-container-orgb2da3b5" class="outline-2">
<h2 id="orgb2da3b5"><span class="section-number-2">4.</span> GHC LANGUAGE options</h2>
<div class="outline-text-2" id="text-4">
<p>
These are options for the GHC compiler to use.
</p>
<div class="org-src-container">
<pre class="src src-haskell">-- vim: tabstop=2 shiftwidth=2 expandtab
  {-# LANGUAGE TypeSynonymInstances #-}
  {-# LANGUAGE MultiParamTypeClasses #-}
</pre>
</div>
</div>
</div>

<div id="outline-container-org2c6cd12" class="outline-2">
<h2 id="org2c6cd12"><span class="section-number-2">5.</span> Imports</h2>
<div class="outline-text-2" id="text-5">
<p>
These are Haskell modules that we must import so that we can use their functions later in the config.
</p>
<div class="org-src-container">
<pre class="src src-haskell">-- Base
import XMonad
import qualified XMonad.StackSet as W

-- Hooks
import XMonad.Hooks.ManageHelpers
import XMonad.Hooks.ManageDocks
import XMonad.Hooks.EwmhDesktops
import XMonad.Hooks.StatusBar
import XMonad.Hooks.StatusBar.PP
import XMonad.Hooks.DynamicIcons
import XMonad.Hooks.Rescreen

-- Utilities
import qualified XMonad.Util.ExtensibleState as XS
import qualified XMonad.Util.Hacks as Hacks
import XMonad.Util.EZConfig
import XMonad.Util.Loggers
import XMonad.Util.SpawnOnce (spawnOnce)

-- Actions
import XMonad.Actions.TiledWindowDragging

-- Layouts
import XMonad.Layout.MultiToggle
import XMonad.Layout.MultiToggle.Instances
import XMonad.Layout.Renamed
import XMonad.Layout.DraggingVisualizer

-- Misc
import qualified Data.Set as S
import qualified Data.Map as M
import Data.Foldable (for_)
import Data.Functor
</pre>
</div>
</div>
</div>

<div id="outline-container-org6bdf00e" class="outline-2">
<h2 id="org6bdf00e"><span class="section-number-2">6.</span> Rescreen configuration</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-haskell">myAfterRescreenHook :: X ()
myAfterRescreenHook = do
  spawn "~/bin/xlayout/post.sh"
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcebe01e" class="outline-2">
<h2 id="orgcebe01e"><span class="section-number-2">7.</span> AppIcon configuration</h2>
<div class="outline-text-2" id="text-7">
<p>
These are icons for applications that are shown in XMobar next to the workspace number.
</p>
<div class="org-src-container">
<pre class="src src-haskell">myIcons :: Query [String]
myIcons = composeAll
  [ className =? "Chromium"    --&gt; appIcon "\xf268"
  , className =? "steam"       --&gt; appIcon "\xf04d3"
  , className =? "Pavucontrol" --&gt; appIcon "\xf04c3"
  , className =? "XTerm"       --&gt; appIcon "\xf489"
  , className =? "Emacs"       --&gt; appIcon "\xe632"
  , className =? "Vmware"      --&gt; appIcon "\xea7a"
  , className =? "qpwgraph"    --&gt; appIcon "\xf07e5"
  , className =? "mpv"         --&gt; appIcon "\xf52c"
  ]

myIconConfig :: IconConfig
myIconConfig = def { iconConfigIcons = myIcons
		   , iconConfigFmt = iconsFmtAppend unwords }
</pre>
</div>
</div>
</div>

<div id="outline-container-orge677595" class="outline-2">
<h2 id="orge677595"><span class="section-number-2">8.</span> Status bar configuration</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-haskell">mySB = statusBarProp "xmobar" (dynamicIconsPP myIconConfig myPP)

myPP :: PP
myPP = def { ppCurrent = xmobarColor "yellow" "" . wrap "[" " ]"
	   , ppTitle   = xmobarColor "green" "" . shorten 40
	   , ppVisible = wrap "(" ")"
	   , ppUrgent  = xmobarColor "red" "yellow"
	   , ppExtras  = [logTitles formatFocused formatUnfocused]
	   , ppOrder   = \(ws:l:t:e) -&gt; [ws, l] ++ e
	   }
	  where
	    formatFocused = wrap "[" "]" . xmobarColor "#ff79c6" "" . shorten 50 . xmobarStrip
	    formatUnfocused = wrap "(" ")" . xmobarColor "#bd93f9" "" . shorten 30 . xmobarStrip
</pre>
</div>
</div>
</div>

<div id="outline-container-org588033f" class="outline-2">
<h2 id="org588033f"><span class="section-number-2">9.</span> Workspaces</h2>
<div class="outline-text-2" id="text-9">
<p>
I am setting the amount of workspaces I want to use here.
</p>
<div class="org-src-container">
<pre class="src src-haskell">myWorkspaces :: [WorkspaceId]
myWorkspaces = map show [1 .. 9 :: Int]
</pre>
</div>
</div>
</div>

<div id="outline-container-org38c0817" class="outline-2">
<h2 id="org38c0817"><span class="section-number-2">10.</span> Main block and Keybinds</h2>
<div class="outline-text-2" id="text-10">
<div class="org-src-container">
<pre class="src src-haskell">main :: IO ()
main = xmonad
       . docks
       . ewmhFullscreen
       . ewmh
       . addAfterRescreenHook myAfterRescreenHook
       $ withEasySB mySB defToggleStrutsKey def
	  { modMask = mod1Mask
	  , terminal = "xterm"
	  , borderWidth = 2
	  , workspaces = myWorkspaces
	  , manageHook = myManageHook
	  , layoutHook = myLayoutHook
	  , startupHook = myStartupHook
	  , logHook = raiseSaved
	  , handleEventHook = handleEventHook def
			      &lt;&gt; Hacks.trayerPaddingXmobarEventHook
	  , XMonad.mouseBindings = Main.mouseBindings
	  }
	  -- Keybinds
	  `additionalKeysP`
	  [ ("M-p", spawn "dmenu_run -fn 'DejaVu Sans Mono:pixelsize=18' -nf 'gray' -nb 'black' -sb 'red' -sf 'white'")
	  , ("M-f", sendMessage $ Toggle Main.FULL)
	  , ("&lt;XF86AudioRaiseVolume&gt;", spawn "$HOME/bin/dvol -i 2" )
	  , ("&lt;XF86AudioLowerVolume&gt;", spawn "$HOME/bin/dvol -d 2" )
	  , ("&lt;XF86AudioMute&gt;", spawn "$HOME/bin/dvol -t" )
	  , ("M-r e", spawn "$HOME/bin/rain-sounds.sh") ]
</pre>
</div>
</div>

<div id="outline-container-orgd065712" class="outline-3">
<h3 id="orgd065712"><span class="section-number-3">10.1.</span> Mouse keybinds</h3>
<div class="outline-text-3" id="text-10-1">
<div class="org-src-container">
<pre class="src src-haskell">-- | Mouse bindings: default actions bound to mouse events
-- | (Taken from XMonad source)
mouseBindings :: XConfig Layout -&gt; M.Map (KeyMask, Button) (Window -&gt; X ())
mouseBindings (XConfig {XMonad.modMask = modMask}) = M.fromList
    -- mod-button1 %! Set the window to floating mode and move by dragging
    [ ((modMask, button1), \w -&gt; focus w &gt;&gt; mouseMoveWindow w
					  &gt;&gt; windows W.shiftMaster)
    , ((modMask .|. shiftMask, button1), dragWindow)
    -- mod-button2 %! Raise the window to the top of the stack
    , ((modMask, button2), windows . (W.shiftMaster .) . W.focusWindow)
    -- mod-button3 %! Set the window to floating mode and resize by dragging
    , ((modMask, button3), \w -&gt; focus w &gt;&gt; mouseResizeWindow w
					 &gt;&gt; windows W.shiftMaster)
    -- you may also bind events to the mouse scroll wheel (button4 and button5)
    , ((modMask, button4), \w -&gt; focus w &gt;&gt; windows W.swapUp)
    , ((modMask, button5), \w -&gt; focus w &gt;&gt; windows W.swapDown)
    -- , ((modMask, button8), \w -&gt; focus w &gt;&gt; windows W.focusUp
    --                                      &gt;&gt; updPointer)
    -- , ((modMask, button9), \w -&gt; focus w &gt;&gt; windows W.focusDown
    --                                      &gt;&gt; updPointer)
    ]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org993ceb9" class="outline-2">
<h2 id="org993ceb9"><span class="section-number-2">11.</span> Startuphook</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">
<pre class="src src-haskell">myStartupHook :: X ()
myStartupHook = do
  spawnOnce "trayer --edge top --align right --SetDockType true \
	    \--SetPartialStrut true --expand true --width 4 \
	    \--transparent true --tint 0x000000 --alpha 0 --height 17"
  spawnOnce "sleep 1 &amp;&amp; xeyes"
  spawnOnce "xclock"
  spawnOnce "xterm"
  spawnOnce "xsettingsd -c ~/.xsettingsd-twm"
</pre>
</div>
</div>
</div>
<div id="outline-container-org6f6155d" class="outline-2">
<h2 id="org6f6155d"><span class="section-number-2">12.</span> Misc</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-org20edf53" class="outline-3">
<h3 id="org20edf53"><span class="section-number-3">12.1.</span> iconPath function</h3>
<div class="outline-text-3" id="text-12-1">
<ul class="org-ul">
<li>This function is used to make specifiying icons for layouts or transformers easier because I don't have to specify an entire path everytime.</li>
</ul>
<div class="org-src-container">
<pre class="src src-haskell">iconPath a = "&lt;icon=/home/yaslam/.config/xmobar/icons/" ++ a ++ "/&gt;"
</pre>
</div>
</div>
</div>

<div id="outline-container-org1fb9e3c" class="outline-3">
<h3 id="org1fb9e3c"><span class="section-number-3">12.2.</span> Slightly modified layout transformer</h3>
<div class="outline-text-3" id="text-12-2">
<ul class="org-ul">
<li>This is a layout transformer that I took from the <a href="https://hackage.haskell.org/package/xmonad-contrib-0.17.1/docs/src/XMonad.Layout.MultiToggle.Instances.html#StdTransformers">XMonad-Contrib source code</a> and edited slightly to change the name into an icon. A layout transformer is a layout that you can dynamically apply to any layout that you are using in XMonad, like for example, you press Alt-f for a temporary fullscreen layout transformer on the current window.</li>
</ul>
<div class="org-src-container">
<pre class="src src-haskell">data StdTransformers = FULL          -- ^ switch to Full layout
  deriving (Read, Show, Eq)

instance Transformer Main.StdTransformers Window where
    transform Main.FULL         x k = k (renamed [Replace $ iconPath "layout-full.xbm"] Full) (const x)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7d34884" class="outline-2">
<h2 id="org7d34884"><span class="section-number-2">13.</span> Layouthook</h2>
<div class="outline-text-2" id="text-13">
<p>
Each layouts name has been replaced with an icon using the <a href="#org20edf53">iconPath function</a> and the renamed module from XMonad-Contrib.
</p>
<ul class="org-ul">
<li>These layouts are mostly the default XMonad layouts.</li>
</ul>
<div class="org-src-container">
<pre class="src src-haskell">myLayoutHook = mkToggle (Main.FULL ?? EOT)
	       $ avoidStruts
	       (tiled ||| mtiled ||| full)
  where
     -- default tiling algorithm partitions the screen into two panes
     tiled   = renamed [Replace $ iconPath "layout-tiled.xbm"] $ draggingVisualizer $ Tall nmaster delta ratio

     mtiled   = renamed [Replace $ iconPath "layout-mtiled.xbm"] $ draggingVisualizer $ Mirror tiled

     full = renamed [Replace $ iconPath "layout-full.xbm"] $ Full

     -- The default number of windows in the master pane
     nmaster = 1

     -- Default proportion of screen occupied by master pane
     ratio   = 1/2

     -- Percent of screen to increment by when resizing panes
     delta   = 3/100
</pre>
</div>
</div>
</div>

<div id="outline-container-org4b5e7e6" class="outline-2">
<h2 id="org4b5e7e6"><span class="section-number-2">14.</span> Misc</h2>
<div class="outline-text-2" id="text-14">
<p>
The 5 blocks of code below basically let me spawn a window that is fully ignored by XMonad (won't get focused, can't be moved etc..), and it is perfect for a program like xeyes which you can use like a dock with this code.
</p>
<div class="org-src-container">
<pre class="src src-haskell">-- provided by geekosaur on IRC
data SavedWindow = SavedWindow (S.Set Window) deriving (Read, Show)

-- provided by geekosaur on IRC
instance ExtensionClass SavedWindow where
  initialValue = SavedWindow S.empty
  extensionType = PersistentExtension

-- use in ManageHook: className =? "whatever" --&gt; saveWindow
-- provided by geekosaur on IRC
saveWindow :: ManageHook
saveWindow = ask &gt;&gt;= \w -&gt; liftX (XS.modify (\(SavedWindow s) -&gt; SavedWindow (S.insert w s))) &gt;&gt; doIgnore

-- use in logHook: no parameters
-- provided by geekosaur on IRC
raiseSaved :: X ()
raiseSaved = do
  SavedWindow s &lt;- XS.get
  withDisplay $ \d -&gt; for_ s $ io . raiseWindow d

-- this lets you have a floating window that is fully ignored
-- but also lets you control the placement of the ignored floating window
-- thanks to [Leary] on #xmonad for this
-- use like: mapAt (Rectangle x y w h) &lt;&gt; doIgnore
-- in the manageHook
mapAt :: Rectangle -&gt; ManageHook
mapAt r = ask &gt;&gt;= \w -&gt; liftX (tileWindow w r $&gt; mempty)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7ceeec6" class="outline-2">
<h2 id="org7ceeec6"><span class="section-number-2">15.</span> Managehook</h2>
<div class="outline-text-2" id="text-15">
<p>
This is where you specify how windows will be shown by XMonad (e.g: the workspace it will be shown on, whether it's floating or tiled etc..)
</p>
<div class="org-src-container">
<pre class="src src-haskell">myManageHook :: ManageHook
myManageHook = composeAll $
	       [ className =? "XClock" --&gt; mapAt (Rectangle 1760 30 150 150) &lt;&gt; saveWindow
	       , className =? "XEyes" --&gt; mapAt (Rectangle 1860 1020 60 60) &lt;&gt; saveWindow
	       , className =? "qpwgraph" --&gt; doShift (myWorkspaces !! 1)
	       , className =? "Pavucontrol" --&gt; doShift (myWorkspaces !! 1)
	       , className =? "mpv" --&gt; doShift (myWorkspaces !! 1)
	       , isFullscreen &lt;&amp;&amp;&gt; className =? "dzen" --&gt; doRaise
	       , className =? "dzen" --&gt; doIgnore &lt;&gt; doLower ]
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Yusef Aslam</p>
<p class="date">Created: 2023-10-14 Sat 18:10</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
